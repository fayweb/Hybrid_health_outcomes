# can the infection intensity predict weight loss?
model_WL <- lm(predicted_WL ~  delta_ct_cewe_MminusE, data = Field_infected)
summary(model_WL)
confint(model_WL)
model_WL_infection <-
ggpredict(model_WL) %>%
plot(colors = "darkorange2") +   # Use a refined shade of blue
labs(title = NULL) +
xlab("Infection intensity of Eimeria spp. in the caecum") +
ylab("Predicted values of weight loss") +
theme_bw()
model_WL_infection
## -How about the oocysts?
ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
Field2 <- Field %>%
drop_na(OPG)
ggplot(data = Field2, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
## -How about the oocysts?
ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") #+
## -How about the oocysts?
ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
Field2 <- Field %>%
drop_na(OPG)
ggplot(data = Field2, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
cor.test(Field2$predicted_WL, Field2$OPG)
## -How about the oocysts?
ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
Field2 <- Field %>%
drop_na(OPG)
ggplot(data = Field2, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
shapiro.test(Field$OPG) # non normal distribution
shapiro.test(Field_infected$predicted_WL) # normal distribution
shapiro.test(Field_infected$delta_ct_cewe_MminusE) # non normal distribution
shapiro.test(Field$OPG) # non normal distribution
cor.test(Field2$predicted_WL, Field2$OPG,  method=c("spearman"), exact=FALSE)
cor.test(Field2$predicted_WL, Field2$OPG,  method= "spearman", exact=FALSE)
cor.test(Field2$predicted_WL, Field2$OPG,  method= "spearman", exact = FALSE)
## -How about the oocysts?
ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
## -How about the oocysts?
ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
View(Field)
Field$OPG
Field$OPG_O
Field$OOC
Field$OO4sq
## -How about the oocysts?
ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
## -How about the oocysts?
ggplot(data = Field %>%
filter(!OPG == 0), aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
Field_infected <- Field %>%
filter(!OPG == 0)
cor.test(Field_infected$predicted_WL, Field_infected$OPG,  method= "spearman", exact = FALSE)
model_WL_infection <-
ggpredict(model_WL) %>%
plot(colors = "darkorange2") +   # Use a refined shade of blue
labs(title = NULL) +
xlab("Infection intensity of Eimeria spp. in the caecum") +
ylab("Predicted values of weight loss") +
theme_bw()
model_WL_infection
# Create the scatter plot for the variable OPG
Cor_infection_wl <- ggplot(data = Field_infected, aes(x = predicted_WL, y = OPG)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp. (OPG)"
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
)
# Create the scatter plot for the variable OPG
Cor_infection_wl <- ggplot(data = Field_infected, aes(x = predicted_WL, y = OPG)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp. (OPG)"
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
)
Cor_infection_wl
# Create the scatter plot for the variable OPG
Cor_infection_wl <- ggplot(data = Field_infected, aes(x = predicted_WL, y = OPG)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp. (OPG)"
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
scale_x_log10()
Cor_infection_wl
# Create the scatter plot for the variable OPG
Cor_infection_wl <- ggplot(data = Field, aes(x = predicted_WL, y = OPG)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp. (OPG)"
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
scale_x_log10()
Cor_infection_wl
# Create the scatter plot for the variable OPG
Cor_infection_wl <- ggplot(data = Field, aes(x = predicted_WL, y = OPG)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp. (OPG)"
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
scale_x_log10()
Cor_infection_wl
## -How about the oocysts?
ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
# Create the scatter plot for the variable OPG
Cor_infection_wl <- ggplot(data = Field, aes(x = predicted_WL, y = OPG)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp. (OPG)"
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
scale_x_log10()
Cor_infection_wl
# Create the scatter plot for the variable OPG
Cor_infection_wl <- ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp. (OPG)"
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
scale_x_log10()
Cor_infection_wl
# Create the scatter plot
ggplot(data = Field_infected, aes(x = delta_ct_cewe_MminusE, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp."
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) -> Cor_infection_wl
Cor_infection_wl
# Create the scatter plot
ggplot(data = Field, aes(x = delta_ct_cewe_MminusE, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp."
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) -> Cor_infection_wl
Cor_infection_wl
# Create the scatter plot
ggplot(data = Field %>%
filter(MC.Eimeria == "TRUE"), aes(x = delta_ct_cewe_MminusE, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp."
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) -> Cor_infection_wl
Cor_infection_wl
ggsave(paste0(an_fi, "/correlation_intensity_pred_WL.jpeg"), Cor_infection_wl)
# Create the scatter plot
ggplot(data = Field %>%
filter(MC.Eimeria == "TRUE"), aes(y = delta_ct_cewe_MminusE, x = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp."
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) -> Cor_infection_wl
Cor_infection_wl
# Create the scatter plot
ggplot(data = Field %>%
filter(MC.Eimeria == "TRUE"), aes(x = delta_ct_cewe_MminusE, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp."
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) -> Cor_infection_wl
Cor_infection_wl
# Create the scatter plot
ggplot(data = Field %>%
filter(MC.Eimeria == "TRUE"), aes(x = delta_ct_cewe_MminusE, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp."
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) -> Cor_infection_wl
Cor_infection_wl
# Create the scatter plot
ggplot(data = Field %>%
filter(MC.Eimeria == "TRUE"), aes(x = delta_ct_cewe_MminusE, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Infection Intensity of Eimeria spp."
y = "Predicted Maximum Weight Loss",
Cor_infection_wl
# Create the scatter plot
ggplot(data = Field %>%
filter(MC.Eimeria == "TRUE"), aes(x = delta_ct_cewe_MminusE, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs( x = "Infection Intensity of Eimeria spp."
y = "Predicted Maximum Weight Loss",) +
Cor_infection_wl
# Create the scatter plot
ggplot(data = Field %>%
filter(MC.Eimeria == "TRUE"), aes(x = delta_ct_cewe_MminusE, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs( x = "Infection Intensity of Eimeria spp.",
y = "Predicted Maximum Weight Loss",) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) -> Cor_infection_wl
Cor_infection_wl
# Is the predicted weight loss correlated to the infection intensities?
cor.test(Field_infected$predicted_WL, Field_infected$delta_ct_cewe_MminusE,
method=c("spearman"), exact=FALSE)
# can the infection intensity predict weight loss?
model_WL <- lm(predicted_WL ~  delta_ct_cewe_MminusE, data = Field_infected)
# Can the predicted weight loss be predicted by infection intensities
# infected samples
Field_infected <- Field %>%
drop_na(delta_ct_cewe_MminusE) %>%
filter(infection_status == TRUE)
# Create the scatter plot
ggplot(data = Field_infected, aes(x = delta_ct_cewe_MminusE, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs( x = "Infection Intensity of Eimeria spp.",
y = "Predicted Maximum Weight Loss",) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) -> Cor_infection_wl
Cor_infection_wl
ggsave(paste0(an_fi, "/correlation_intensity_pred_WL.jpeg"), Cor_infection_wl)
plot(Field_infected$predicted_WL, Field_infected$delta_ct_cewe_MminusE)
# Create the scatter plot
ggplot(data = Field_infected, aes(x = delta_ct_cewe_MminusE, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs( x = "Infection Intensity of Eimeria spp.",
y = "Predicted Maximum Weight Loss",) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) -> Cor_infection_wl
Cor_infection_wl
ggsave(paste0(an_fi, "/correlation_intensity_pred_WL.jpeg"), Cor_infection_wl)
plot(Field_infected$predicted_WL, Field_infected$delta_ct_cewe_MminusE)
shapiro.test(Field_infected$predicted_WL) # normal distribution
shapiro.test(Field_infected$delta_ct_cewe_MminusE) # non normal distribution
lm_model <- lm(predicted_WL ~ delta_ct_cewe_MminusE, data = Field_infected)
plot(lm_model$residuals)
# Is the predicted weight loss correlated to the infection intensities?
cor.test(Field_infected$predicted_WL, Field_infected$delta_ct_cewe_MminusE,
method=c("spearman"), exact=FALSE)
# can the infection intensity predict weight loss?
model_WL <- lm(predicted_WL ~  delta_ct_cewe_MminusE, data = Field_infected)
summary(model_WL)
confint(model_WL)
model_WL_infection <-
ggpredict(model_WL) %>%
plot(colors = "darkorange2") +   # Use a refined shade of blue
labs(title = NULL) +
xlab("Infection intensity of Eimeria spp. in the caecum") +
ylab("Predicted values of weight loss") +
theme_bw()
model_WL_infection
## -How about the oocysts?
ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point() +
stat_smooth(method= "lm") +
scale_x_log10()
# Create the scatter plot for the variable OPG
Cor_infection_wl <- ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp. (OPG)"
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
scale_x_log10()
Cor_infection_wl
# Create the scatter plot for the variable OPG
Cor_OPG_wl <- ggplot(data = Field, aes(x = OPG, y = predicted_WL)) +
geom_point(color = "black", size = 3, alpha = 0.6) +   # Plot the data points with specified color, size, and transparency
geom_smooth(method = "lm", se = TRUE, color = "blue", linetype = "solid", size = 1) +  # Add a linear trend line with confidence interval
geom_smooth(method = "loess", se = TRUE, color = "red", linetype = "dashed", size = 1) +  # Add a smoothing line with confidence interval
labs(
x = "Predicted Maximum Weight Loss",
y = "Infection Intensity of Eimeria spp. (OPG)"
) +
theme_minimal(base_size = 15) +  # Use a minimal theme with larger base font size for better readability
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 18),  # Center the plot title and adjust its style
plot.subtitle = element_text(hjust = 0.5, size = 14),  # Center the plot subtitle and adjust its size
axis.title = element_text(face = "bold"),  # Bold axis titles
panel.grid.major = element_line(color = "grey80"),  # Subtle grid lines for major grids
panel.grid.minor = element_blank()  # Remove minor grid lines
) +
scale_x_log10()
Cor_OPG_wl
shapiro.test(Field$OPG) # non normal distribution
cor.test(Field2$predicted_WL, Field2$OPG,  method= "spearman", exact = FALSE)
shapiro.test(Field$OPG) # non normal distribution
cor.test(Field2$predicted_WL, Field2$OPG,  method= "spearman", exact = FALSE)
model <- lm(predicted_WL ~  OPG, data = Field)
summary(model)
confint(model)
## Let'S dive into it further
# what about a combination of the oocyst and infection intensity data with qpcr?
model <- lm(predicted_WL ~  OPG * delta_ct_cewe_MminusE, data = Field)
summary(model)
confint(model)
Field$infection_status
## Let'S dive into it further
# what about a combination of the oocyst and infection intensity data with qpcr?
model <- lm(predicted_WL ~  infection_status * delta_ct_cewe_MminusE, data = Field)
summary(model)
plot_summs(model)
summary(model)
confint(model)
## Let'S dive into it further
# what about a combination of the oocyst and infection intensity data with qpcr?
model <- lm(predicted_WL ~  infection_status * delta_ct_cewe_MminusE, data = Field)
summary(model)
confint(model)
plot_summs(model)
